# MarketApi
<p>Web-api для взамодействия с базой данных сети магазинов.</p>
<h2>Запуск сервера</h2>
<p>Данное решение работает с использованием базы данных <b>PostgreSQL</b>. Чтобы подключиться к базе нужно в файле <code>Startup.cs</code> найти строчку:
<pre>services.AddDbContext<ApplicationContext>(opt => opt.UseNpgsql("Host=localhost;Port=5432;Database=MarketDB;Username=postgres;Password=PostgresTest"));</pre>
<p>И ввести значения соответствующие <b>вашей</b> базе данных.</p>
<p>Для запуска сервера, нужно в терминале windows (или PowerShell) открыть папку с проектом и ввести команду <code>dotnet run</code>.
Убедитесь что на компьютере установлен .NET версии 5.0</p>
<h2>Инструкция</h2>
<p><b>Перед началом работы</b> с базой данных нужно провести её первоначальное заполнение. Для этого нужно отправить на сервер пустой <code>GET</code> запрос по адресу <code>api/values</code></p>
<p>В для хранения в базе данных различных сущностей имеются модели, список всех моделей представлен ниже:</p>
<ul>
  <li><b>Product</b> – модель товара</li>
  <li><b>SalesPoint</b> – точка продажи товаров</li>
  <li><b>Buyer</b> – покупатель, лицо, осуществляющее покупку товара или услуги в одной из
точек продаж</li>
  <li><b>Sale</b> – Акт продажи</li>
  <li><b>ProvidedProduct</b> – модель товара доступного к продаже
в конкретной точке продажи с доступным количеством товаров.</li>
  <li><b>SaleData</b> - Модель продавамого товара относящемуся к конкретной продаже</li>
</ul>
<p>К каждой модели доступны CRUD операции, то есть можно редактировать любую сущность базы данных.
Однако существует простая бизнес-логика, согласно которой можно совершить покупку в магазине, при этом количество доступных товаров в данном магазине изменится,
в базе данных появится сущность с соответствующей продажей, а у покупателя (если он уже есть в базе) появится новая покупка.
Ниже представлен пример <code>POST</code> запроса в базу данных для создания новой продажи:</p>
<pre>
{
    "salesPointId": 1,
    "buyerId": 1,
    "salesData": [
        {
            "productId": 1,
            "productQuantity": 3
        },
        {
            "productId": 2,
            "productQuantity": 3
        }
    ]
}
</pre>
<p>Он отправляется на сервер по адресу <code>/api/NewSale</code></p>
<p>Для взаимодействия с сущностями для каждой модели существуют соответствующие адреса, по которым нужно обращаться к апи.
Ниже представлена таблица адресов:</p>
<table>
  <tr>
    <td>Product</td><td>/api/Products</td>
  </tr>
  <tr>
    <td>SalesPoint</td><td>/api/SalesPoints</td>
  </tr>
  <tr>
    <td>Buyer</td><td>/api/Buyers</td>
  </tr>
  <tr>
    <td>Sale</td><td>/api/Sales</td>
  </tr>
  <tr>
    <td>ProvidedProduct</td><td>/api/ProvidedProducts</td>
  </tr>
  <tr>
    <td>SaleData</td><td>/api/SalesData</td>
  </tr>
</table>
<p>Пример результата <code>GET</code> запроса по адресу <code>/api/SalesPoints</code>:</p>
<pre>
[
    {
        "id": 1,
        "name": "столовая \"Полисмен\""
    },
    {
        "id": 2,
        "name": "кафе \"Как дома\""
    }
]
</pre>
<p>Также на проекте реализован функционал <b>Swagger</b>, доступный по адресу <code>/swagger/index.html</code>:</p>
